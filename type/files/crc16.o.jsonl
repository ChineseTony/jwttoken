{"function": "crc16", "raw_code": "__int16 __fastcall crc16(_BYTE *@@VAR_2@@a1@@constchar, int @@VAR_0@@a2@@int)\n{\n  __int64 @@VAR_1@@v2@@v2; // rsi\n  __int16 @@VAR_3@@result@@uint16t; // ax\n\n  if ( @@VAR_0@@a2@@int <= 0 )\n    return 0;\n  @@VAR_1@@v2@@v2 = (__int64)&@@VAR_2@@a1@@constchar[@@VAR_0@@a2@@int - 1 + 1];\n  @@VAR_3@@result@@uint16t = 0;\n  do\n    @@VAR_3@@result@@uint16t = crc16tab[(unsigned __int8)(*@@VAR_2@@a1@@constchar++ ^ HIBYTE(@@VAR_3@@result@@uint16t))] ^ (@@VAR_3@@result@@uint16t << 8);\n  while ( @@VAR_2@@a1@@constchar != (_BYTE *)@@VAR_1@@v2@@v2 );\n  return @@VAR_3@@result@@uint16t;\n}\n", "ast": {"node_type": "block", "node_id": 0, "children": [{"node_type": "if", "node_id": 1, "children": [{"node_type": "block", "node_id": 2, "children": [{"node_type": "return", "node_id": 3, "children": [{"node_type": "num", "node_id": 4, "type": "__int16", "name": "0", "address": "00000038"}], "address": "00000038"}], "address": "00000038"}, {"node_type": "sle", "node_id": 5, "address": "00000002", "y": {"node_type": "num", "node_id": 7, "type": "int", "name": "0", "address": "00000002"}, "x": {"new_name": "int", "parent_address": "00000002", "var_id": "VAR_0", "old_name": "a2", "node_type": "var", "node_id": 6, "address": "FFFFFFFFFFFFFFFF", "type": "int", "ref_width": 4}, "type": "bool"}], "address": "00000002"}, {"node_type": "expr", "node_id": 8, "children": [{"node_type": "asg", "node_id": 9, "address": "0000000E", "y": {"x": {"x": {"parent_address": "0000000E", "node_type": "idx", "node_id": 13, "address": "FFFFFFFFFFFFFFFF", "y": {"parent_address": "0000000E", "node_type": "add", "node_id": 15, "address": "FFFFFFFFFFFFFFFF", "y": {"node_type": "num", "node_id": 19, "type": "int", "name": "1", "address": "0000000E"}, "x": {"node_type": "sub", "node_id": 16, "address": "00000004", "y": {"node_type": "num", "node_id": 18, "type": "int", "name": "1", "address": "00000004"}, "x": {"new_name": "int", "parent_address": "00000004", "var_id": "VAR_0", "old_name": "a2", "node_type": "var", "node_id": 17, "address": "FFFFFFFFFFFFFFFF", "type": "int", "ref_width": 4}, "type": "int"}, "type": "int"}, "x": {"new_name": "constchar", "parent_address": "0000000E", "var_id": "VAR_2", "old_name": "a1", "node_type": "var", "node_id": 14, "address": "FFFFFFFFFFFFFFFF", "type": "_BYTE *", "ref_width": 8}, "type": "_BYTE"}, "node_type": "ref", "node_id": 12, "type": "_BYTE *", "address": "0000000E"}, "node_type": "cast", "node_id": 11, "type": "__int64", "address": "0000000E"}, "x": {"new_name": "v2", "parent_address": "0000000E", "var_id": "VAR_1", "old_name": "v2", "node_type": "var", "node_id": 10, "address": "FFFFFFFFFFFFFFFF", "type": "__int64", "ref_width": 8}, "type": "__int64"}], "address": "0000000E"}, {"node_type": "expr", "node_id": 20, "children": [{"node_type": "asg", "node_id": 21, "address": "00000013", "y": {"node_type": "num", "node_id": 23, "type": "__int16", "name": "0", "address": "00000013"}, "x": {"new_name": "uint16t", "parent_address": "00000013", "var_id": "VAR_3", "old_name": "result", "node_type": "var", "node_id": 22, "address": "FFFFFFFFFFFFFFFF", "type": "__int16", "ref_width": 2}, "type": "__int16"}], "address": "00000013"}, {"node_type": "do", "node_id": 24, "children": [{"node_type": "block", "node_id": 25, "children": [{"node_type": "expr", "node_id": 26, "children": [{"node_type": "asg", "node_id": 27, "address": "00000028", "y": {"node_type": "xor", "node_id": 29, "address": "00000028", "y": {"node_type": "shl", "node_id": 40, "address": "0000001F", "y": {"name": "8", "parent_address": "0000001F", "node_type": "num", "node_id": 42, "address": "FFFFFFFFFFFFFFFF", "type": "int"}, "x": {"new_name": "uint16t", "parent_address": "0000001F", "var_id": "VAR_3", "old_name": "result", "node_type": "var", "node_id": 41, "address": "FFFFFFFFFFFFFFFF", "type": "__int16", "ref_width": 2}, "type": "int"}, "x": {"node_type": "idx", "node_id": 30, "address": "00000028", "y": {"x": {"node_type": "xor", "node_id": 33, "address": "00000022", "y": {"parent_address": "00000022", "node_type": "call", "node_id": 37, "address": "FFFFFFFFFFFFFFFF", "x": {"name": "HIBYTE", "parent_address": "00000022", "node_type": "helper", "node_id": 38, "address": "FFFFFFFFFFFFFFFF", "type": "_BYTE __fastcall(__int16)"}, "type": "_BYTE", "children": [{"new_name": "uint16t", "parent_address": "00000022", "var_id": "VAR_3", "old_name": "result", "node_type": "var", "node_id": 39, "address": "FFFFFFFFFFFFFFFF", "type": "__int16", "ref_width": 1}]}, "x": {"node_type": "ptr", "node_id": 34, "address": "00000022", "x": {"x": {"new_name": "constchar", "parent_address": "00000022", "var_id": "VAR_2", "old_name": "a1", "node_type": "var", "node_id": 36, "address": "FFFFFFFFFFFFFFFF", "type": "_BYTE *", "ref_width": 8}, "node_type": "postinc", "node_id": 35, "type": "_BYTE *", "address": "00000022"}, "type": "_BYTE", "pointer_size": 1}, "type": "int"}, "node_type": "cast", "node_id": 32, "type": "unsigned __int8", "address": "00000022"}, "x": {"node_type": "obj", "node_id": 31, "name": "_WORD[256]", "parent_address": "00000028", "address": "FFFFFFFFFFFFFFFF", "type": "_WORD[256]", "ref_width": -1}, "type": "_WORD"}, "type": "int"}, "x": {"new_name": "uint16t", "parent_address": "00000028", "var_id": "VAR_3", "old_name": "result", "node_type": "var", "node_id": 28, "address": "FFFFFFFFFFFFFFFF", "type": "__int16", "ref_width": 2}, "type": "__int16"}], "address": "00000028"}], "address": "00000028"}, {"node_type": "ne", "node_id": 43, "address": "0000002F", "y": {"parent_address": "0000002F", "node_type": "cast", "node_id": 45, "address": "FFFFFFFFFFFFFFFF", "x": {"new_name": "v2", "parent_address": "0000002F", "var_id": "VAR_1", "old_name": "v2", "node_type": "var", "node_id": 46, "address": "FFFFFFFFFFFFFFFF", "type": "__int64", "ref_width": 8}, "type": "_BYTE *"}, "x": {"new_name": "constchar", "parent_address": "0000002F", "var_id": "VAR_2", "old_name": "a1", "node_type": "var", "node_id": 44, "address": "FFFFFFFFFFFFFFFF", "type": "_BYTE *", "ref_width": 8}, "type": "bool"}], "address": "0000002F"}, {"node_type": "return", "node_id": 47, "children": [{"new_name": "uint16t", "parent_address": "00000031", "var_id": "VAR_3", "old_name": "result", "node_type": "var", "node_id": 48, "address": "FFFFFFFFFFFFFFFF", "type": "__int16", "ref_width": 2}], "address": "00000031"}], "address": "00000002"}}
